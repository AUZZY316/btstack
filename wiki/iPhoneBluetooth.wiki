#summary This page reviews the Bluetooth controller on the Apple's iPhone and iPod touch and explains how it can be used independently from the OS

= Introduction =

So far, the OS on the iPhone and the iPod touch only supports the use of Bluetooth headsets. However, this is not a limitation of the used Bluetooth chipset, but of an incomplete Bluetooth stack. According to Apple's presentation in Mar '09, the upcoming OS 3.0 will provide more Bluetooth functionality. At least the standard OBEX protocol for the exchange of business cards, calendar items, notes, and pictures will be supported, even with other mobile phones. But that's about it. OS 3.0 will further support iPhone-to-iPhone connections intended for local gaming and connection to devices "Made for iPhone" over a closed and proprietary protocol. It is highly unlikely that it will support basic Bluetooth protocols like L2CAP or RFCOMM. 

= Hardware Details =

Both generation of the iPhone (2G and 3G versions) use Bluetooth chipsets from Cambridge Silicon Radio (CSR), one of the leading Bluetooth vendors. CSR provides a wealth of documentation in their [http://csrsupport.com technical support area] (free login required). The first generation iPhone contains a !BlueCore 4, the second generation (current 3G models) contains a !BlueCore 6 chipset. The iPod touch second generation contains a Broadcom chipset, a company not famous for providing developer information.

= Software Details =

On the iPhone and the iPod touch, the Bluetooth functionality is provided by BTserver, a background daemon. No further information is available about it. However, to control the Bluetooth chipset, the BTserver makes use of the !BlueTool. The !BlueTool tool provides a command-line interface for changing the operation mode (on/off/sleep..) and to configure various details of the Bluetooth chipset. The configuration used on the iPhone is rather complex, but fortunately, Apple provides commented initialization scripts in /etc/bluetool. By just feeding the script for the actual Bluetooth chipset to !BlueTool, Bluetooth is fully initialized. The iPhones are configured for the [HCI_UART_Transport H5 transport protocol] and a baudrate of 2.4 megabit per second. On the iPod touch, the firmware for the Broadcom chipset is loaded first before it is also configured for 2.4 mbps. In contrast to the iPhone, the basic H4 transport protocol is used and the Bluetooth MAC address has to be set with the !BlueTool.

= iPhone / iPod touch Support in BTstack =
Initially, BTstack will only support the [HCI_UART_Transport H4 transport mode]. Support for the [HCI_UART_Transport H5 or the CSR BCSP protocol] might be implemented later. In order to use the CSR module for H4 mode, the script provided by Apple is parsed and modified on-the-fly before feeding it to !BlueTool to match the desired configuration.